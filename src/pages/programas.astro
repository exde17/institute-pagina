---
import Layout from '../layouts/Layout.astro';

// Programas con sus im√°genes y detalles
const programasData = [
  {
    id: 'fotovoltaicos',
    nombre: 'Instalaci√≥n de Paneles Solares',
    imagen: '/img/flyers/FOTOVOLTAICOS.png',
    descripcion: 'Convi√©rtete en un experto en energ√≠as renovables. Aprende a dise√±ar, instalar y mantener sistemas fotovoltaicos residenciales y comerciales.',
    duracion: '6 meses',
    modalidad: 'Presencial',
    categoria: 'T√©cnico',
    badge: 'Popular',
    badgeColor: 'green',
    detalles: [
      'Fundamentos de energ√≠a solar',
      'Dise√±o de sistemas fotovoltaicos',
      'Instalaci√≥n y mantenimiento',
      'Normatividad y certificaciones',
      'Pr√°cticas en proyectos reales'
    ]
  },
  {
    id: 'marketing',
    nombre: 'Marketing y Redes Sociales',
    imagen: '/img/flyers/MARKETING Y REDES SOCIALES.png',
    descripcion: 'Domina las estrategias digitales m√°s efectivas. Crea contenido que impacta y gestiona comunidades en l√≠nea para impulsar marcas en el mundo digital.',
    duracion: '3 semestres',
    modalidad: 'Presencial',
    categoria: 'Marketing Digital',
    badge: 'Trending',
    badgeColor: 'purple',
    semestres: [
      {
        numero: 'I',
        nombre: 'Fundamentos y Comunicaci√≥n',
        materias: [
          'Audiovisuales',
          'Comunicaci√≥n I',
          'Comunicaci√≥n II',
          'Creaci√≥n de Contenido',
          'Ingl√©s B√°sico',
          'Inducci√≥n',
          'TICs'
        ]
      },
      {
        numero: 'II',
        nombre: 'Marketing Digital',
        materias: [
          'Investigaci√≥n de Mercado',
          'Estrategia de Mercadeo',
          'Marketing Digital I',
          'Marketing Digital II',
          'Desarrollo Humano',
          'Gesti√≥n Empresarial I'
        ]
      },
      {
        numero: 'III',
        nombre: 'Aplicaci√≥n Profesional',
        materias: [
          'Pr√°ctica Empresarial'
        ]
      }
    ],
    detalles: [
      'Community Management profesional',
      'Estrategias de contenido viral',
      'Publicidad en redes sociales',
      'Anal√≠tica y m√©tricas digitales',
      'Gesti√≥n de crisis online'
    ]
  },
  {
    id: 'innovacion',
    nombre: 'Gesti√≥n de la Innovaci√≥n',
    imagen: '/img/flyers/GESTI√ìN DE LA INNOVACI√ìN.png',
    descripcion: 'Lidera proyectos innovadores y transforma ideas en realidad. Desarrolla habilidades de emprendimiento y gesti√≥n de proyectos disruptivos.',
    duracion: '5 meses',
    modalidad: 'H√≠brido',
    categoria: 'Emprendimiento',
    badge: 'Nuevo',
    badgeColor: 'blue',
    detalles: [
      'Metodolog√≠as √°giles y Design Thinking',
      'Gesti√≥n de proyectos innovadores',
      'Creatividad y pensamiento lateral',
      'Pitch y presentaci√≥n de proyectos',
      'Financiamiento y escalamiento'
    ]
  },
  {
    id: 'agroindustria',
    nombre: 'Agroindustria Sostenible',
    imagen: '/img/flyers/AGROINDUSTRIA.png',
    descripcion: 'Aprende t√©cnicas modernas de producci√≥n agroindustrial. Desarrolla proyectos sostenibles que generen impacto social y ambiental positivo.',
    duracion: '6 meses',
    modalidad: 'Presencial',
    categoria: 'Agricultura',
    badge: 'Certificado',
    badgeColor: 'emerald',
    detalles: [
      'T√©cnicas de cultivo sostenible',
      'Procesamiento y valor agregado',
      'Gesti√≥n de proyectos agr√≠colas',
      'Comercializaci√≥n y mercados',
      'Certificaciones org√°nicas'
    ]
  },
  {
    id: 'culturales',
    nombre: 'Programas Culturales y Art√≠sticos',
    imagen: '/img/flyers/CULTURALES Y ARTISTICOS.png',
    descripcion: 'Descubre y potencia tu talento art√≠stico. Participa en talleres de m√∫sica, danza, teatro y artes pl√°sticas con instructores profesionales.',
    duracion: '3 meses',
    modalidad: 'Presencial',
    categoria: 'Arte y Cultura',
    badge: 'Creativo',
    badgeColor: 'pink',
    detalles: [
      'Talleres de m√∫sica y canto',
      'Danza folcl√≥rica y moderna',
      'Teatro y expresi√≥n corporal',
      'Artes pl√°sticas y pintura',
      'Presentaciones y recitales'
    ]
  },
  {
    id: 'deportes',
    nombre: 'Deportes y Recreaci√≥n',
    imagen: '/img/flyers/DEPORTES Y RECREACI√ìN.png',
    descripcion: 'Promueve h√°bitos de vida saludable a trav√©s del deporte. Participa en programas de f√∫tbol, voleibol, atletismo y actividades recreativas.',
    duracion: '3 meses',
    modalidad: 'Presencial',
    categoria: 'Deporte y Salud',
    badge: 'Activo',
    badgeColor: 'orange',
    detalles: [
      'Entrenamiento deportivo b√°sico',
      'Disciplinas: f√∫tbol, voleibol, atletismo',
      'Actividades recreativas grupales',
      'Nutrici√≥n deportiva b√°sica',
      'Torneos y competencias'
    ]
  }
];
---
<Layout title="Programas ‚Äî Instituto Fundaci√≥n">
  <section class="mx-auto max-w-7xl px-4 py-12">
    <header class="mb-12 text-center animate-fade-in">
      <h1 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-blue-800 via-purple-700 to-blue-600 bg-clip-text text-transparent mb-4">
        Nuestros Programas de Formaci√≥n
      </h1>
      <div class="w-24 h-1 bg-gradient-to-r from-blue-600 to-purple-600 mx-auto rounded-full mb-6"></div>
      <p class="text-lg text-slate-600 max-w-3xl mx-auto">
        Explora nuestra oferta completa de programas dise√±ados para transformar tu futuro profesional y personal.
      </p>
      <div class="mt-6 flex flex-wrap justify-center gap-3">
        <span class="px-4 py-2 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold">üìö 6 Programas</span>
        <span class="px-4 py-2 bg-purple-100 text-purple-800 rounded-full text-sm font-semibold">üë• +500 Estudiantes</span>
        <span class="px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-semibold">‚úì Certificados</span>
      </div>
    </header>

    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
      {programasData.map((programa, index) => (
        <article 
          class="programa-card bg-white rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-500 group"
          style={`animation-delay: ${index * 0.1}s`}
        >
          <!-- Imagen del programa -->
          <div class="relative h-64 overflow-hidden">
            <img 
              src={programa.imagen} 
              alt={programa.nombre}
              class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent opacity-70"></div>
            
            <!-- Badge -->
            <div class={`absolute top-4 right-4 px-3 py-1 rounded-full text-xs font-bold text-white ${
              programa.badgeColor === 'green' ? 'bg-green-500' :
              programa.badgeColor === 'purple' ? 'bg-purple-500' :
              programa.badgeColor === 'blue' ? 'bg-blue-500' :
              programa.badgeColor === 'emerald' ? 'bg-emerald-500' :
              programa.badgeColor === 'pink' ? 'bg-pink-500' :
              'bg-orange-500'
            }`}>
              {programa.badge}
            </div>

            <!-- T√≠tulo sobre la imagen -->
            <div class="absolute bottom-0 left-0 right-0 p-4 text-white z-10">
              <h2 class="text-2xl font-bold mb-1 group-hover:text-yellow-400 transition-colors">
                {programa.nombre}
              </h2>
              <span class="inline-block px-2 py-1 bg-white/20 backdrop-blur-sm rounded text-xs font-semibold">
                {programa.categoria}
              </span>
            </div>
          </div>

          <!-- Contenido -->
          <div class="p-6">
            <p class="text-slate-600 text-sm leading-relaxed mb-4">
              {programa.descripcion}
            </p>

            <!-- Detalles del programa -->
            <div class="mb-4 space-y-2">
              <h3 class="text-sm font-bold text-slate-700 mb-2">üìã Contenido del programa:</h3>
              
              {/* Si el programa tiene semestres, mostrar estructura semestral */}
              {programa.semestres ? (
                <div class="space-y-3">
                  <div class="semestres-preview">
                    {programa.semestres.map((semestre, idx) => (
                      <div class="bg-slate-50 rounded-lg p-3 border border-slate-200">
                        <div class="flex items-center gap-2 mb-2">
                          <div class="w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 text-white flex items-center justify-center text-xs font-bold">
                            {semestre.numero}
                          </div>
                          <div>
                            <div class="text-xs font-bold text-slate-800">{semestre.nombre}</div>
                            <div class="text-xs text-slate-500">{semestre.materias.length} materias</div>
                          </div>
                        </div>
                        <ul class="space-y-1 ml-10">
                          {semestre.materias.slice(0, idx === 0 ? 2 : 0).map((materia) => (
                            <li class="text-xs text-slate-600 flex items-start gap-2">
                              <svg class="w-3 h-3 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                              </svg>
                              {materia}
                            </li>
                          ))}
                        </ul>
                      </div>
                    ))}
                  </div>
                  
                  <div class="semestres-full hidden">
                    {programa.semestres.map((semestre, idx) => (
                      <div class="bg-gradient-to-br from-slate-50 to-blue-50 rounded-lg p-4 border-2 border-blue-200 mb-3">
                        <div class="flex items-center gap-3 mb-3">
                          <div class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 text-white flex items-center justify-center text-sm font-bold shadow-lg">
                            {semestre.numero}
                          </div>
                          <div>
                            <div class="text-sm font-bold text-slate-900">{semestre.nombre}</div>
                            <div class="text-xs text-slate-600">{semestre.materias.length} materias</div>
                          </div>
                        </div>
                        <ul class="space-y-2 ml-13">
                          {semestre.materias.map((materia) => (
                            <li class="text-xs text-slate-700 flex items-start gap-2 bg-white px-3 py-2 rounded-md shadow-sm">
                              <svg class="w-4 h-4 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                              </svg>
                              <span class="font-medium">{materia}</span>
                            </li>
                          ))}
                        </ul>
                      </div>
                    ))}
                  </div>
                </div>
              ) : (
                /* Si no tiene semestres, mostrar lista de detalles tradicional */
                <ul class="space-y-1">
                  {programa.detalles.slice(0, 3).map(detalle => (
                    <li class="text-xs text-slate-600 flex items-start gap-2">
                      <svg class="w-4 h-4 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                      </svg>
                      {detalle}
                    </li>
                  ))}
                </ul>
              )}
              
              <button 
                class="show-more-btn text-xs text-blue-600 hover:text-blue-800 font-semibold mt-2 flex items-center gap-1"
                data-programa-id={programa.id}
              >
                Ver m√°s detalles
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              </button>
            </div>

            <!-- Info adicional -->
            <div class="flex gap-2 mb-4">
              <div class="flex-1 bg-gradient-to-br from-purple-500 to-pink-500 text-white text-center py-2 px-3 rounded-lg">
                <div class="text-xs opacity-90">Duraci√≥n</div>
                <div class="text-sm font-bold">{programa.duracion}</div>
              </div>
              <div class="flex-1 bg-gradient-to-br from-blue-500 to-cyan-500 text-white text-center py-2 px-3 rounded-lg">
                <div class="text-xs opacity-90">Modalidad</div>
                <div class="text-sm font-bold">{programa.modalidad}</div>
              </div>
            </div>

            <!-- Bot√≥n de acci√≥n -->
            <button 
              class="btn-inscribir w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl px-4 py-3 font-bold transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl"
              data-programa-nombre={programa.nombre}
            >
              <span class="flex items-center justify-center gap-2">
                Inscribirme ahora
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                </svg>
              </span>
            </button>
          </div>
        </article>
      ))}
    </div>

    <!-- CTA Final -->
    <div class="mt-16 text-center bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-8 text-white">
      <h2 class="text-3xl font-bold mb-4">¬øListo para transformar tu futuro?</h2>
      <p class="text-lg mb-6 opacity-90">
        √önete a nuestra comunidad de m√°s de 500 estudiantes que ya est√°n construyendo su camino al √©xito.
      </p>
      <a 
        href="/contacto" 
        class="inline-flex items-center gap-2 bg-white text-blue-600 px-8 py-4 rounded-xl font-bold hover:bg-slate-100 transform hover:scale-105 transition-all duration-300 shadow-xl"
      >
        Cont√°ctanos ahora
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
        </svg>
      </a>
    </div>
  </section>

  <style>
    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slide-up {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fade-in 0.6s ease-out;
    }

    .programa-card {
      animation: slide-up 0.6s ease-out backwards;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .programa-card:hover {
      transform: translateY(-12px);
    }

    .btn-inscribir {
      position: relative;
      overflow: hidden;
    }

    .btn-inscribir::after {
      content: '';
      position: absolute;
      inset-block-start: 50%;
      inset-inline-start: 50%;
      inline-size: 0;
      block-size: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .btn-inscribir:hover::after {
      inline-size: 300px;
      block-size: 300px;
    }

    .details-expanded {
      max-height: 500px;
      transition: max-height 0.5s ease-in-out;
    }
  </style>

  <script>
    // Funci√≥n para manejar "Ver m√°s detalles"
    document.addEventListener('DOMContentLoaded', () => {
      const showMoreButtons = document.querySelectorAll('.show-more-btn');
      
      showMoreButtons.forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const card = (e.currentTarget as HTMLElement).closest('.programa-card');
          
          // Buscar si tiene semestres o detalles tradicionales
          const semestresPreview = card?.querySelector('.semestres-preview');
          const semestresFull = card?.querySelector('.semestres-full');
          const detallesList = card?.querySelector('ul');
          
          if (semestresPreview && semestresFull) {
            // Programa con semestres (como Marketing)
            const isExpanded = !semestresFull.classList.contains('hidden');
            
            if (!isExpanded) {
              // Mostrar todos los semestres
              semestresPreview.classList.add('hidden');
              semestresFull.classList.remove('hidden');
              (e.currentTarget as HTMLElement).innerHTML = `
                Ver menos detalles
                <svg class="w-3 h-3 transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              `;
            } else {
              // Ocultar detalles completos
              semestresPreview.classList.remove('hidden');
              semestresFull.classList.add('hidden');
              (e.currentTarget as HTMLElement).innerHTML = `
                Ver m√°s detalles
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              `;
            }
          } else if (detallesList) {
            // Programa con lista tradicional de detalles
            const isExpanded = detallesList.classList.contains('details-expanded');
            
            if (!isExpanded) {
              // Mostrar todos los detalles
              detallesList.classList.add('details-expanded');
              (e.currentTarget as HTMLElement).innerHTML = `
                Ver menos detalles
                <svg class="w-3 h-3 transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              `;
            } else {
              // Ocultar detalles extras
              detallesList.classList.remove('details-expanded');
              (e.currentTarget as HTMLElement).innerHTML = `
                Ver m√°s detalles
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                </svg>
              `;
            }
          }
        });
      });

      // Funci√≥n para manejar inscripci√≥n
      const inscribirButtons = document.querySelectorAll('.btn-inscribir');
      
      inscribirButtons.forEach(btn => {
        btn.addEventListener('click', (e) => {
          const programaNombre = (e.currentTarget as HTMLElement).dataset.programaNombre;
          
          // Verificar si hay token (usuario logueado)
          const token = localStorage.getItem('token');
          
          if (!token) {
            if (confirm(`Para inscribirte en "${programaNombre}" debes iniciar sesi√≥n. ¬øDeseas ir al login?`)) {
              window.location.href = '/auth/login';
            }
            return;
          }

          // Redirigir a p√°gina de contacto o inscripci√≥n
          if (confirm(`¬øDeseas inscribirte en "${programaNombre}"? Te redirigiremos a la p√°gina de contacto.`)) {
            window.location.href = `/contacto?programa=${encodeURIComponent(programaNombre || '')}`;
          }
        });
      });
    });
  </script>
</Layout>
